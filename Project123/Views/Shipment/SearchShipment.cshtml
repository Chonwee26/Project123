
@{
    Layout = "~/Views/Shared/_PostLayout.cshtml";
}

@section Styles{
    <style type="text/css">
        body {
            background-color: #f9fbfd;
        }

        container {
            background-color: black;
        }

        .card {
            background-color: white;
        }

        #liveChat {
            height: 40px;
            width: 100px;
            display: flex;
            position: sticky;
            justify-content: flex-end;
            align-content: flex-end;
        }

        .carousel-item img {
            height: 500px; /* Adjust the height as needed */
            object-fit: cover; /* Ensure the image covers the fixed height */
        }

        #carouselExampleCaptions {
            margin: 0; /* Reset margin for the carousel container */
        }
    </style>
}

<div class="container">
    <div class="row">
        <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1" hidden></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2" hidden></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3" hidden></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="~/picture/thailand.jpg" class="d-block w-100" alt="">
                    @*<div class="carousel-caption d-none d-md-block">
                            <h5>First slide label</h5>
                            <p>Some representative placeholder content for the first slide.</p>
                        </div>*@
                </div>
                <div class="carousel-item">
                    <img src="~/picture/Japan-2107x1406.jpg" class="d-block w-100" alt="...">

                </div>
                <div class="carousel-item">
                    <img src="~/picture/iceland.jpg" class="d-block w-100" alt="...">

                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
</div>

<form id="frmSearchShipment">
    <div class="col-9 offset-3 mt-4">
        <h1 class="">เช็คเลขพัสดุ Chowii Express</h1>
        <div class="col-12">
            <div class="row">

                <div class="col-8">
                    <input type="text" id="txtOrderNumber" class="form-control" name="OrderNumber"placeholder="ใส่หมายเลขพัสดุ" />
                </div>

                <div class="col-3">
                    <button type="submit" class="btn btn-primary px-4" id="btnSearch">Tracking</button>
                </div>

            </div>
        </div>
    </div>

    @*<div class="card mt-4 py-4">
        <div class="row">
            <div class="content col-6">
                <label id="idPost"></label>
            </div>

            <div class="arriveDate">

                <label></label>
            </div>
        </div>
    </div>*@
</form>
@*<button class="btn-outline-primary" id="liveChat">Live Chat</button>*@

<div class="container mt-5" id="containerSection">
    <div class="card">
        <div class="card-body">


            <div id="shipmentInfo" class="mt-3"></div>
        </div>
    </div>
</div>

@section Scripts{
    <script type="text/javascript">
        $(document).ready(function () {
            $("#containerSection").hide();
        });
        $('#liveChat').click(function () {
            var liveChat = $('#liveChat');
            liveChat.toggle();
        });
        $('#frmSearchShipment').validate({
            rules: {

            },
            messages: {

            },
            errorPlacement: function (error, element) {

            },
            submitHandler: function (form) {
                var inputDate = $('#txtSearchShipDateFR').val();
                var formattedDate = "";

                // Check if inputDate is a valid date in the format DD/MM/YYYY
                if (moment(inputDate, 'DD/MM/YYYY', true).isValid()) {
                    // If valid, format the date as YYYY-MM-DD
                    formattedDate = moment(inputDate, 'DD/MM/YYYY').format('YYYY-MM-DD');
                    inputDate = formattedDate;
                }
                var frmSearch = $('#frmSearchShipment').serialize();

                var frmSearch1 = {
                    OrderNumber: $('#txtOrderNumber').val()
                }

                @*$.ajax
                    ({
                        type: 'POST',
                        url: '@Url.Action("SearchShipmentAll", "Shipment")',
                        data: frmSearch1,
                        dataType: "json",
                        success: function (result) {

                            if (result.Message == "S") {
                                debugger
                                displayShipmentInfo(result.Data);
                            }

                            else {
                                SweetAlert('error', 'กรุณาใส่ข้อมูลให้ถูกต้อง');
                            }
                        },
                        error: function (request, status, error) {
                            SweetAlert('error', error);
                        }
                    });
                }*@
                $.ajax
                    ({
                        type: 'POST',
                        url: '@Url.Action("SearchShipmentAsync", "Test")',
                        data: frmSearch1,
                        dataType: "json",
                        success: function (result) {
                            debugger
                            if (result.status == "S") {
                                debugger
                                if (result.Data.length > 0) {
                                    $("#containerSection").show();
                                    displayShipmentInfo(result.Data);
                                }
                                else {
                                    SweetAlert('error', 'กรุณาใส่ข้อมูลให้ถูกต้อง');
                                }
                            }

                            else {
                                SweetAlert('error', 'กรุณาใส่ข้อมูลให้ถูกต้อง');
                            }
                        },
                        error: function (request, status, error) {
                            SweetAlert('error', error);
                        }
                    });
                }

        });

        function displayShipmentInfo(shipmentInfo) {
            debugger
            var Data = shipmentInfo.find(f => f.OrderNumber == shipmentInfo[0].OrderNumber);
            var picture;
            var choosePicture;
            choosePicture = Data.ShipmentStatusList[0].ShipmentItemID
            if (choosePicture == "1") {
                picture = "/picture/box.png"


            }
            else if (choosePicture == "2") {
                picture =
                   "/picture/truckani.gif"
            }

            else if (choosePicture == "3") {
                picture =
                    "/picture/warehouse.png"
            }

            else if (choosePicture == "4") {
                picture =
                   "/picture/scooterani.gif"
            }
            else if (choosePicture == "5") {
                picture =
                "/picture/5988246.png"
            }
            var html = `
            <div class="accordion accordion-flush" id="accordionExample">
    <div class="accordion-item">
        <h2 class="accordion-header">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                <!-- Button Content -->
            </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
            <div class="accordion-body">
                <div>
                    <div class="d-flex justify-content-around">
                        <img src= ${picture} style="height:200px;width:200px;" class="m-3" />
                    </div>
                    <h3 class="text-center">${Data.ShipmentStatusList[0].ShipmentItemText}</h3> 
                   
                </div>


            </div>
          

        </div>
    </div>
</div>
                <hr>
  <h6>Shipment ID: ${Data.ShipmentId}</h6>
  <p>Order Number: ${Data.OrderNumber}</p>
  <p>Full Name: ${Data.FullName}</p>
  <p>Mobile Number: ${Data.MobileNumber}</p>
  <p>Storage: ${Data.ShipmentLocation[0].ShipmentItemText}</p>
  <p>Shipment Status: ${Data.ShipmentStatusList[0].ShipmentItemText}</p>
  <p>Ship Date: ${Data.ShipDate}</p>
  <p>Create Date: ${Data.CreateDate}</p>
`;
                $('#shipmentInfo').html(html);
        }
    </script>
}


